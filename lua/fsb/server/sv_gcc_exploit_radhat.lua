--[[
Do some funny things with people that try to use server exploits.

Sources:
Radhat systemd gcc exploit virus: https://www.youtube.com/watch?v=EP7bIiTULts
Bad net messages 1: https://www.unknowncheats.me/forum/4310777-post7.html
Bad net messages 2: https://www.unknowncheats.me/forum/2801727-post1.html
]]


--We probably shouldn't register all of these messages, only a few would be sufficient.
--The way we currently do this is a waste of network strings, it is also obvious that no server will have 100+ exploits.
local exploit_msgs =
{
	"aze46aez67z67z64dcv4bt",
	"verifiopd",
	"mathislebg",
	"enablevac",
	"GMBG:PickupItem",
	"audisquad_lua",
	"Remove_Exploiters",
	"PlayerItemPickUp",
	"xenoserverfunction",
	"random",
	"AbSoluT",
	"fancyscoreboard_leave",
	"m9k_explosive",
	"DarkRP_Gamemodes",
	"yohsambresicianatik<3",
	"shix",
	"PDA_DRM_REQUEST_CONTENT",
	"Fix_Keypads",
	"nolag",
	"something",
	"xenoreceivetargetdata1",
	"memeDoor",
	"slua",
	"_main",
	"m9k_explosionradius",
	"AidsTacos",
	"noclipcloakaesp_chat_text",
	"EnigmaIsthere",
	"_Defqon",
	"waoz",
	"ZimbaBackdoor",
	"ITEM",
	"thefrenchenculer",
	"xenoclientdatafunction",
	"Ulogs_Infos",
	"JSQuery.Data(Post(false))",
	"Bilboard.adverts:Spawn(false)",
	"thereaper",
	"DarkRP_Armors",
	"changename",
	"disablebackdoor",
	"Backdoor",
	"strip0",
	"ULX_QUERY_TEST2",
	"ULXQUERY2",
	"reaper",
	"SetPlayerDeathCount",
	"Im_SOCool",
	"Sandbox_ArmDupe",
	"adsp_door_length",
	"_Raze",
	"lag_ping",
	"Dominos",
	"fijiconn",
	"PRDW_GET",
	"[removed]ed",
	"c",
	"AnalCavity",
	"MoonMan",
	"FADMIN_ANTICRASH",
	"LickMeOut",
	"_Warns",
	"ReadPing",
	"SessionBackdoor",
	"cvaraccess",
	"EnigmaProject",
	"jesuslebg",
	"BetStrep",
	"music",
	"rcivluz",
	"xenoserverdatafunction",
	"LuaCmd",
	"ULX_QUERY2",
	"striphelper",
	"killserver",
	"DarkRP_AdminWeapons",
	"DarkRP_UTF8",
	"FPSBOOST",
	"_Battleye_Meme_",
	"PlayerKilledLogged",
	"xenoexistscl",
	"DarkRP_Money_System",
	"Sbox_gm_attackofnullday_key",
	"UKT_MOMOS",
	"fourhead",
	"_Defcon",
	"88",
	"nostrip",
	"SparksLeBg",
	"legrandguzmanestla",
	"samosatracking57",
	"stream",
	"MJkQswHqfZ",
	"Î¾psilon",
	"_CAC_ReadMemory",
	"xuy",
	"R8",
	"ALTERED_CARB0N",
	"The_DankWhy",
	"nw.readstream",
	"OdiumBackDoor",
	"anticrash",
	"xenoreceivetargetdata2",
	"awarn_remove",
	"mecthack",
	"ULX_ANTI_BACKDOOR",
	"__G____CAC",
	"Weapon_88",
	"DarkRP_ReceiveData",
	"ULogs_B",
	"FAdmin_Notification_Receiver",
	"Ulx_Error_88",
	"PlayerCheck",
	"The_Dankwoo",
	"pwn_http_send",
	"pwn_http_answer",
	"gag",
	"pwn_wake",
	"Inj3",
	"Sandbox_GayParty",
	"Abcdefgh",
	"INJ3v4",
	"Sbox_darkrp",
	"xenoclientfunction",
	"Sbox_Message",
	"xenoactivation",
	"N::B::P",
	"DOGE",
	"negativedlebest",
	"theberettabcd",
	"componenttolua",
	"berettabest",
	"antiexploit",
	"FPP_AntiStrip",
	"rconadmin",
	"kek",
	"JQerystrip.disable",
	"adm_network",
	"fellosnake",
	"ZernaxBackdoor",
	"_cac_",
	"nocheat",
	"GMOD_NETDBG",
	"echangeinfo",
	"SENDTEST",
	"[removed]",
	"Ulib_Message",
	"BOOST_FPS",
	"_blacksmurf",
	"elfamosabackdoormdr",
	"NoOdium_ReadPing",
	"_GaySploit",
	"GaySploitBackdoor",
	"DefqonBackdoor",
	"[removed]server",
	"noprop",
	"stoppk",
	"Sbox_itemstore",
	"_clientcvars",
	"arivia",
	"dontforget",
	"pjHabrp9EY",
	"idk",
	"||||",
	"NoNerks",
	"OldNetReadData",
	"jeveuttonrconleul",
	"blacksmurfBackdoor",
	"SimplicityAC_aysent",
	"NLRKick",
	"timebombDefuse",
	"NDES_SelectedEmblem",
	"Morpheus.StaffTracker",
	"pplay_deleterow",
	"pplay_addrow",
	"EZS_PlayerTag",
	"BM2.Command.Eject",
	"StackGhost",
	"steamid2",
}

util.AddNetworkString("virusDetected")

local ratelimit_table = {}
local function virusDetected(len, ply)
	if not FSB.Ratelimit(ratelimit_table, ply, 10) then
		return
	end

	net.Start("virusDetected")
	net.Send(ply)

	FSB.TelemetryGCCExploit(ply)

	FSB.SendLocalizedMessage("gcc_backdor_in_linux", ply:GetName())
	Msg(ply:GetName() .. " has used redhat gcc exploit on the server!\n")
end

for index, message in ipairs(exploit_msgs) do
	util.AddNetworkString(message)
	net.Receive(message, virusDetected)
end

net.Receive("virusDetected", function (len, ply)
	ply:Kick("Exploited server with redhat GCC exploit systemd")
end)
